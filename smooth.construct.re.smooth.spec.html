<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html><head><title>R: Simple random effects in GAMs</title>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 <link rel="stylesheet" type="text/css" href="R.css">
 </head><body>
 
 <table width="100%" summary="page for smooth.construct.re.smooth.spec"><tr><td>smooth.construct.re.smooth.spec</td><td align="right">R Documentation</td></tr></table>
 
 <h2>Simple random effects in GAMs</h2>
 
 <h3>Description</h3>
 
 <p><code>gam</code> can deal with simple independent random effects, by exploiting the link 
 between smooths and random effects to treat random effects as smooths. <code>s(x,bs="re")</code> implements 
 this. Such terms can can have any number of predictors, which can be any mixture of numeric or factor 
 variables. The terms produce a parametric interaction of the predictors, and penalize the corresponding 
 coefficients with a multiple of the identity matrix, corresponding to an assumption of i.i.d. normality.
 See details.
 </p>
 
 
 <h3>Usage</h3>
 
 <pre>
 ## S3 method for class 're.smooth.spec'
 smooth.construct(object, data, knots)
 ## S3 method for class 'random.effect'
 Predict.matrix(object, data)
 </pre>
 
 
 <h3>Arguments</h3>
 
  
 <table summary="R argblock">
 <tr valign="top"><td><code>object</code></td>
 <td>
 <p>For the <code>smooth.construct</code> method a smooth specification object, 
 usually generated by a term <code>s(x,...,bs="re",)</code>. For the <code>predict.Matrix</code> method 
 an object of class <code>"random.effect"</code> produced by the <code>smooth.construct</code> method.</p>
 </td></tr>
 <tr valign="top"><td><code>data</code></td>
 <td>
 <p>a list containing just the data (including any <code>by</code> variable) required by this term, 
 with names corresponding to <code>object$term</code> (and <code>object$by</code>). The <code>by</code> variable 
 is the last element.</p>
 </td></tr> 
 <tr valign="top"><td><code>knots</code></td>
 <td>
 <p>generically a list containing any knots supplied for basis setup &mdash; unused at present.</p>
 </td></tr>
 </table>
 
 
 <h3>Details</h3>
 
 <p>Exactly how the random effects are implemented is best seen by example. Consider the model 
 term <code>s(x,z,bs="re")</code>. This will result in the model matrix component corresponding to <code>~x:z-1</code> 
 being added to the model matrix for the whole model. The coefficients associated with the model matrix 
 component are assumed i.i.d. normal, with unknown variance (to be estimated). This assumption is 
 equivalent to an identity penalty matrix (i.e. a ridge penalty) on the coefficients. Because such a 
 penalty is full rank, random effects terms do not require centering constraints. 
 </p>
 <p>If the nature of the random effect specification is not clear, consider a couple more examples: 
 <code>s(x,bs="re")</code> results in <code>model.matrix(~x-1)</code> being appended to the overall model matrix, 
 while  <code>s(x,v,w,bs="re")</code> would result in  <code>model.matrix(~x:v:w-1)</code> being appended to the model 
 matrix. In both cases the corresponding model coefficients are assumed i.i.d. normal, and are hence 
 subject to ridge penalties.
 </p>
 <p>Note that smooth <code>id</code>s are not supported for random effect terms. Unlike most smooth terms, side 
 conditions are never applied to random effect terms in the event of nesting (since they are identifiable 
 without side conditions).
 </p>
 <p>Random effects implemented in this way do not exploit the sparse structure of many random effects, and 
 may therefore be relatively inefficient for models with large numbers of random effects, when <code>gamm4</code>
 or <code>gamm</code> may be better alternatives. Note also that <code>gam</code> will not support 
 models with more coefficients than data. 
 </p>
 
 
 <h3>Value</h3>
 
 <p> An object of class <code>"random.effect"</code> or a matrix mapping the coefficients of the random effect to the random effects themselves.
 </p>
 
 
 <h3>Author(s)</h3>
 
 <p> Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a></p>
 
 
 <h3>References</h3>
 
 
 <p>Wood, S.N. (2008) Fast stable direct fitting and smoothness
 selection for generalized additive models. Journal of the Royal
 Statistical Society (B) 70(3):495-518
 </p>
 
 
 <h3>See Also</h3>
 
 <p><code>gam.vcomp</code>, <code>gamm</code></p>
 
 
 <h3>Examples</h3>
 
 <pre>
 ## see ?gam.vcomp
 </pre>
 
 
 </body></html>
