<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html><head><title>R: Bandwidth Selectors for Kernel Density Estimation</title>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 <link rel="stylesheet" type="text/css" href="R.css">
 </head><body>
 
 <table width="100%" summary="page for bandwidth"><tr><td>bandwidth</td><td align="right">R Documentation</td></tr></table>
 
 <h2>Bandwidth Selectors for Kernel Density Estimation</h2>
 
 <h3>Description</h3>
 
 
 <p>Bandwidth selectors for Gaussian kernels in <code>density</code>.
 </p>
 
 
 <h3>Usage</h3>
 
 <pre>
 bw.nrd0(x)
 
 bw.nrd(x)
 
 bw.ucv(x, nb = 1000, lower = 0.1 * hmax, upper = hmax, tol = 0.1 * lower)
 
 bw.bcv(x, nb = 1000, lower = 0.1 * hmax, upper = hmax, tol = 0.1 * lower)
 
 bw.SJ(x, nb = 1000, lower = 0.1 * hmax, upper = hmax,
       method = c("ste", "dpi"), tol = 0.1 * lower)
 </pre>
 
 
 <h3>Arguments</h3>
 
 
 <table summary="R argblock">
 <tr valign="top"><td><code>x</code></td>
 <td>
 <p>numeric vector.</p>
 </td></tr>
 <tr valign="top"><td><code>nb</code></td>
 <td>
 <p>number of bins to use.</p>
 </td></tr>
 <tr valign="top"><td><code>lower, upper</code></td>
 <td>
 <p>range over which to minimize.  The default is
 almost always satisfactory.  <code>hmax</code> is calculated internally
 from a normal reference bandwidth.</p>
 </td></tr>
 <tr valign="top"><td><code>method</code></td>
 <td>
 <p>either <code>"ste"</code> (&quot;solve-the-equation&quot;) or
 <code>"dpi"</code> (&quot;direct plug-in&quot;).</p>
 </td></tr>
 <tr valign="top"><td><code>tol</code></td>
 <td>
 <p>for method <code>"ste"</code>, the convergence tolerance for
 <code>uniroot</code>.  The default leads to bandwidth estimates
 with only slightly more than one digit accuracy, which is sufficient
 for practical density estimation, but possibly not for theoretical
 simulation studies.</p>
 </td></tr>
 </table>
 
 
 <h3>Details</h3>
 
 
 <p><code>bw.nrd0</code> implements a rule-of-thumb for
 choosing the bandwidth of a Gaussian kernel density estimator.
 It defaults to 0.9 times the
 minimum of the standard deviation and the interquartile range divided by
 1.34 times the sample size to the negative one-fifth power
 (= Silverman's &lsquo;rule of thumb&rsquo;, Silverman (1986, page 48, eqn (3.31))
 <EM>unless</EM> the quartiles coincide when a positive result
 will be guaranteed.
 </p>
 <p><code>bw.nrd</code> is the more common variation given by Scott (1992),
 using factor 1.06.
 </p>
 <p><code>bw.ucv</code> and <code>bw.bcv</code> implement unbiased and
 biased cross-validation respectively.
 </p>
 <p><code>bw.SJ</code> implements the methods of Sheather &amp; Jones (1991)
 to select the bandwidth using pilot estimation of derivatives.<br>
 The algorithm for method <code>"ste"</code> solves an equation (via
 <code>uniroot</code>) and because of that, enlarges the interval
 <code>c(lower,upper)</code> when the boundaries were not user-specified and
 do not bracket the root.
 </p>
 
 
 <h3>Value</h3>
 
 
 <p>A bandwidth on a scale suitable for the <code>bw</code> argument
 of <code>density</code>.
 </p>
 
 
 <h3>References</h3>
 
 
 <p>Scott, D. W. (1992)
 <EM>Multivariate Density Estimation: Theory, Practice, and
 Visualization.</EM>
 Wiley.
 </p>
 <p>Sheather, S. J. and Jones, M. C. (1991)
 A reliable data-based bandwidth selection method for kernel density
 estimation.
 <EM>Journal of the Royal Statistical Society series B</EM>,
 <B>53</B>, 683&ndash;690.
 </p>
 <p>Silverman, B. W. (1986)
 <EM>Density Estimation</EM>.
 London: Chapman and Hall.
 </p>
 <p>Venables, W. N. and Ripley, B. D. (2002)
 <EM>Modern Applied Statistics with S</EM>.
 Springer.
 </p>
 
 
 <h3>See Also</h3>
 
 
 <p><code>density</code>.
 </p>
 <p><code>bandwidth.nrd</code>, <code>ucv</code>,
 <code>bcv</code> and <code>width.SJ</code> in
 package <a href="http://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a>, which are all scaled to the <code>width</code> argument
 of <code>density</code> and so give answers four times as large.
 </p>
 
 
 <h3>Examples</h3>
 
 <pre>
 require(graphics)
 
 plot(density(precip, n = 1000))
 rug(precip)
 lines(density(precip, bw="nrd"), col = 2)
 lines(density(precip, bw="ucv"), col = 3)
 lines(density(precip, bw="bcv"), col = 4)
 lines(density(precip, bw="SJ-ste"), col = 5)
 lines(density(precip, bw="SJ-dpi"), col = 6)
 legend(55, 0.035,
        legend = c("nrd0", "nrd", "ucv", "bcv", "SJ-ste", "SJ-dpi"),
        col = 1:6, lty = 1)
 </pre>
 
 
 </body></html>
